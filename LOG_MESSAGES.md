# StatusLight Application Log Messages Reference

This document provides a comprehensive guide to all log messages generated by the StatusLight application, organized by component and functionality.

## Table of Contents

- [Teams Service Logs](#teams-service-logs)
- [Microsoft Graph Service Logs](#microsoft-graph-service-logs)
- [Govee Service Logs](#govee-service-logs)
- [Status Light View Model Logs](#status-light-view-model-logs)
- [Keychain Service Logs](#keychain-service-logs)
- [Error Messages](#error-messages)
- [Log Message Patterns](#log-message-patterns)

---

## Teams Service Logs

### Authentication and Monitoring

#### `ğŸ”‘ TeamsService: Authentication status changed to: {true/false}`
- **When**: Authentication state changes (login/logout)
- **Purpose**: Track when user signs in or out of Microsoft Teams
- **Values**: `true` = authenticated, `false` = not authenticated

#### `ğŸš€ TeamsService: User is authenticated, starting 15-second monitoring...`
- **When**: User is authenticated and monitoring begins
- **Purpose**: Confirms automatic monitoring startup after successful authentication

#### `ğŸ›‘ TeamsService: User not authenticated, stopping monitoring`
- **When**: User signs out or authentication is lost
- **Purpose**: Confirms monitoring has been stopped due to lack of authentication

### Monitoring Cycle

#### `ğŸš€ TeamsService: Starting 15-second monitoring cycle`
- **When**: `startMonitoring()` is called
- **Purpose**: Indicates the beginning of the Teams status monitoring process

#### `âœ… TeamsService: Initial status fetch completed`
- **When**: First Teams status request succeeds
- **Purpose**: Confirms initial status was retrieved successfully before starting the recurring cycle

#### `âŒ TeamsService: Initial status fetch failed: {error}`
- **When**: First Teams status request fails
- **Purpose**: Indicates initial status retrieval failed but monitoring cycle will still start
- **Follow-up**: Monitoring continues with periodic retry attempts

#### `ğŸ”„ TeamsService: Starting 15-second restart cycle`
- **When**: Initial status fetch completes (success or failure)
- **Purpose**: Confirms the 15-second recurring timer has been established

#### `âœ… TeamsService: 15-second restart cycle timer started`
- **When**: Timer is successfully added to the run loop
- **Purpose**: Confirms timer is active and will fire every 15 seconds

### Timer Operations

#### `ğŸ”„ TeamsService: 15-second restart cycle triggered (valid: {true/false})`
- **When**: Timer fires every 15 seconds
- **Purpose**: Shows each polling attempt with timer validity status
- **Values**: `valid: true` = timer is working, `valid: false` = timer issue

#### `ğŸš€ TeamsService: Restarting Teams monitoring cycle...`
- **When**: Each 15-second timer fires
- **Purpose**: Indicates a new polling cycle is beginning

#### `ğŸ”„ TeamsService: Refreshing Teams status...`
- **When**: About to make API call for status update
- **Purpose**: Shows the specific moment before API request

#### `âœ… TeamsService: Restart cycle status fetch completed`
- **When**: API call in 15-second cycle succeeds
- **Purpose**: Confirms successful status update from periodic polling

#### `âŒ TeamsService: Restart cycle failed: {error}`
- **When**: API call in 15-second cycle fails
- **Purpose**: Shows specific failure in periodic polling
- **Action**: Logging error details for debugging

### Timer Management

#### `ğŸ›‘ TeamsService: Stopping 15-second polling timer`
- **When**: `stopMonitoring()` is called and timer exists
- **Purpose**: Confirms timer is being stopped

#### `âœ… TeamsService: Timer stopped successfully`
- **When**: Timer invalidation completes
- **Purpose**: Confirms clean timer shutdown

#### `â„¹ï¸ TeamsService: No timer to stop`
- **When**: `stopMonitoring()` called but no active timer
- **Purpose**: Indicates safe no-op when stopping non-existent timer

---

## Microsoft Graph Service Logs

### Status Polling Sequence

#### `ğŸ”„ MicrosoftGraphService: Starting Teams status polling attempt...`
- **When**: Every time `refreshPresence()` is called
- **Purpose**: Marks the beginning of each API request sequence
- **Frequency**: Every 15 seconds + manual refreshes

#### `ğŸ“Š MicrosoftGraphService: Checking token validity...`
- **When**: Before making API request
- **Purpose**: Shows token validation step in the process

### Token Management

#### `âœ… MicrosoftGraphService: Token is valid, proceeding with API call`
- **When**: Token passes validation check
- **Purpose**: Confirms API call can proceed without token refresh

#### `ğŸ”„ MicrosoftGraphService: Token expired, refreshing...`
- **When**: Token fails validation check
- **Purpose**: Indicates automatic token refresh is starting

#### `âœ… MicrosoftGraphService: Token refreshed successfully`
- **When**: Token refresh completes successfully
- **Purpose**: Confirms new token is ready for API use

#### `âŒ MicrosoftGraphService: No access token available`
- **When**: No token found in memory
- **Purpose**: Indicates authentication is required before API calls

### API Request Lifecycle

#### `ğŸ“¡ MicrosoftGraphService: Sending GET request to https://graph.microsoft.com/v1.0/me/presence`
- **When**: About to send HTTP request to Microsoft Graph
- **Purpose**: Shows exact API endpoint being called

#### `â±ï¸ MicrosoftGraphService: API request completed in {X.XX}s`
- **When**: HTTP request completes (success or failure)
- **Purpose**: Performance monitoring - shows response time
- **Values**: Time in seconds with 2 decimal precision

#### `ğŸ“¨ MicrosoftGraphService: Received HTTP {status_code} response`
- **When**: HTTP response is received
- **Purpose**: Shows HTTP status code for debugging
- **Values**: 200 (success), 401 (auth), 429 (rate limit), etc.

### Successful Responses

#### `âœ… MicrosoftGraphService: Successfully parsed Teams presence data`
- **When**: JSON response parsed successfully
- **Purpose**: Confirms data structure is valid

#### `ğŸ‘¤ MicrosoftGraphService: Teams status - {status} ({activity})`
- **When**: Status data is extracted from response
- **Purpose**: Shows the actual Teams status received
- **Values**: Available, Busy, Away, etc. with activity details

#### `ğŸ’¬ MicrosoftGraphService: Status message: {message}`
- **When**: User has a custom status message
- **Purpose**: Shows custom status message content
- **Condition**: Only appears if status message exists

#### `âœ… MicrosoftGraphService: Teams status updated successfully - {status} ({activity})`
- **When**: Status is published to subscribers
- **Purpose**: Confirms status update was distributed to UI

### Error Handling

#### `âŒ MicrosoftGraphService: Invalid HTTP response received`
- **When**: Response is not valid HTTP
- **Purpose**: Indicates network or protocol issue

#### `âŒ MicrosoftGraphService: Failed to decode presence response: {error}`
- **When**: JSON parsing fails
- **Purpose**: Shows data format issues with API response

#### `ğŸ” MicrosoftGraphService: Authentication expired (401), attempting token refresh...`
- **When**: API returns 401 Unauthorized
- **Purpose**: Shows authentication issue and automatic retry

#### `âŒ MicrosoftGraphService: Authentication expired, client needs to retry`
- **When**: Token refresh completes after 401
- **Purpose**: Indicates calling code should retry the request

#### `âš ï¸ MicrosoftGraphService: Rate limit exceeded (429) - backing off`
- **When**: API returns 429 Too Many Requests
- **Purpose**: Shows rate limiting is active

#### `âŒ MicrosoftGraphService: Unexpected HTTP status code: {code}`
- **When**: API returns unknown status code
- **Purpose**: Logs unexpected API behavior

#### `ğŸ“„ MicrosoftGraphService: Response body: {body}`
- **When**: Error response received
- **Purpose**: Shows error details from API for debugging

### Token Storage

#### `ğŸ“± MicrosoftGraphService: Loaded stored tokens successfully`
- **When**: App starts and finds valid tokens in Keychain
- **Purpose**: Confirms automatic authentication restoration

#### `ğŸ“± MicrosoftGraphService: No stored tokens found, starting mock data for debugging`
- **When**: App starts without stored tokens
- **Purpose**: Shows fallback to mock data mode

#### `âŒ MicrosoftGraphService: Failed to load stored tokens: {error}`
- **When**: Keychain access fails
- **Purpose**: Shows storage/security issues

### Mock Data (Development Mode)

#### `ğŸ§ª MicrosoftGraphService: Generated mock Teams status: {status}`
- **When**: Mock data mode generates random status
- **Purpose**: Shows simulated status for development/testing

---

## Govee Service Logs

### Device Discovery

#### `ğŸ“± StatusLightViewModel: Received {count} devices from GoveeService`
- **When**: Device list is updated from Govee API
- **Purpose**: Shows number of devices discovered

#### `ğŸ“± StatusLightViewModel: Auto-selecting {count} color-capable devices`
- **When**: First device discovery auto-selects compatible devices
- **Purpose**: Shows automatic device selection logic

### API Operations

#### `ğŸ” Starting Govee device discovery...`
- **When**: Device refresh is initiated
- **Purpose**: Indicates beginning of device discovery process

#### `âœ… Govee device discovery completed successfully`
- **When**: Device discovery succeeds
- **Purpose**: Confirms successful device list retrieval

#### `âŒ Govee device discovery failed: {error}`
- **When**: Device discovery fails
- **Purpose**: Shows specific error in device discovery

---

## Status Light View Model Logs

### Device Management

#### `ğŸ”„ Starting refresh: Teams status + Govee devices...`
- **When**: "Refresh Devices" button is clicked
- **Purpose**: Shows comprehensive refresh operation beginning

#### `âœ… Teams status refresh completed successfully`
- **When**: Teams status refresh in bulk operation succeeds
- **Purpose**: Confirms Teams portion of refresh completed

#### `âœ… Govee device discovery completed successfully`
- **When**: Govee refresh in bulk operation succeeds
- **Purpose**: Confirms Govee portion of refresh completed

#### `âŒ Refresh failed: {error}`
- **When**: Bulk refresh operation fails
- **Purpose**: Shows error in comprehensive refresh

### Light Color Management

#### `ğŸ’¡ StatusLightViewModel: No selected devices to update`
- **When**: Light update attempted but no devices selected
- **Purpose**: Prevents unnecessary processing when no lights configured

#### `ğŸ’¡ StatusLightViewModel: Current color: {r}, {g}, {b}`
- **When**: Before light update evaluation
- **Purpose**: Shows current light state

#### `ğŸ’¡ StatusLightViewModel: Target color: {r}, {g}, {b}`
- **When**: After color calculation
- **Purpose**: Shows what color should be displayed

#### `ğŸ’¡ StatusLightViewModel: Selected devices: {count}`
- **When**: Before device updates
- **Purpose**: Shows how many devices will be updated

### Color Change Operations

#### `ğŸ¨ StatusLightViewModel: Color changed! Sending commands to {count} devices...`
- **When**: Target color differs from current color
- **Purpose**: Indicates active color change operation

#### `ğŸ¨ TERMINAL COLOR LOG: Lights changing from RGB({r},{g},{b}) to RGB({r},{g},{b})`
- **When**: Color change is initiated
- **Purpose**: **High-visibility terminal logging** showing exact color transition

#### `ğŸ“¡ StatusLightViewModel: Sending color RGB({r},{g},{b}) to {device_name}`
- **When**: Sending command to individual device
- **Purpose**: Shows per-device command transmission

#### `âœ… TERMINAL COLOR LOG: Successfully changed {device_name} to RGB({r},{g},{b})`
- **When**: Device command succeeds
- **Purpose**: **High-visibility terminal logging** confirming successful color change

#### `âŒ StatusLightViewModel: Failed to update {device_name}: {error}`
- **When**: Device command fails
- **Purpose**: Shows per-device failure details

#### `ğŸ’¡ StatusLightViewModel: Color unchanged RGB({r},{g},{b}), skipping update`
- **When**: Target color matches current color
- **Purpose**: Shows optimization - no redundant commands sent

### Color Determination Logic

#### `ğŸ¯ StatusLightViewModel: Determining target color...`
- **When**: Beginning color calculation process
- **Purpose**: Shows start of priority-based color logic

#### `ğŸ“… StatusLightViewModel: Upcoming meeting found - {minutes} minutes until start`
- **When**: Meeting detected in calendar
- **Purpose**: Shows meeting-based color priority activation

#### `ğŸ”´ StatusLightViewModel: Using ACTIVE meeting color: RGB({r},{g},{b})`
- **When**: Currently in a meeting
- **Purpose**: Shows highest priority color (active meeting)

#### `ğŸŸ  StatusLightViewModel: Using 1-minute warning color: RGB({r},{g},{b})`
- **When**: Meeting starts in â‰¤1 minute
- **Purpose**: Shows critical meeting countdown color

#### `ğŸŸ¡ StatusLightViewModel: Using 5-minute warning color: RGB({r},{g},{b})`
- **When**: Meeting starts in â‰¤5 minutes  
- **Purpose**: Shows urgent meeting countdown color

#### `ğŸ”µ StatusLightViewModel: Using 15-minute warning color: RGB({r},{g},{b})`
- **When**: Meeting starts in â‰¤15 minutes
- **Purpose**: Shows early meeting countdown color

#### `ğŸ“… StatusLightViewModel: No upcoming meetings`
- **When**: No meetings found in calendar
- **Purpose**: Shows fallback to Teams status priority

#### `ğŸ‘¤ StatusLightViewModel: Using Teams status color for {status}: RGB({r},{g},{b})`
- **When**: Using Teams status for color (no meetings)
- **Purpose**: Shows medium priority color (Teams status)

#### `ğŸ‘¤ StatusLightViewModel: No Teams status available`
- **When**: No Teams status available
- **Purpose**: Shows fallback to default color

#### `â“ StatusLightViewModel: Using default color: RGB({r},{g},{b})`
- **When**: No other color source available
- **Purpose**: Shows lowest priority color (default/unknown)

---

## Keychain Service Logs

### Token Storage Operations

These logs are implicit through successful/failed operations but don't have explicit console output. Errors would appear in:

#### `âŒ MicrosoftGraphService: Failed to load stored tokens: {error}`
#### `Failed to authenticate with Teams: {error}`
#### `Failed to configure Govee API key: {error}`

---

## Error Messages

### Teams Authentication Errors

#### `Failed to authenticate with Teams: Client ID not configured. Please set up Azure app registration.`
- **Cause**: Azure app registration not properly configured
- **Action**: Update MicrosoftGraphConfig.clientId with valid Azure app ID

#### `Failed to authenticate with Teams: Authentication with Microsoft failed`
- **Cause**: User canceled OAuth flow or network issues
- **Action**: Retry authentication, check network connectivity

#### `Failed to authenticate with Teams: Authentication has expired`
- **Cause**: Tokens expired and refresh failed
- **Action**: Re-authenticate with Microsoft Teams

### Govee API Errors

#### `Failed to configure Govee API key: {specific_error}`
- **Cause**: Invalid API key or network issues
- **Action**: Verify API key, check network connectivity

#### `âŒ Govee API key test failed - check your key`
- **Cause**: API key test returned invalid response
- **Action**: Verify API key is correct and active

#### `Failed to refresh Govee devices: {specific_error}`
- **Cause**: API rate limits, network issues, or invalid key
- **Action**: Wait for rate limit reset, check connectivity

### Device Control Errors

#### `Failed to update {device_name}: {specific_error}`
- **Cause**: Device offline, API limits, or network issues
- **Action**: Check device connectivity, verify API limits

---

## Log Message Patterns

### Emoji Usage Guide

| Emoji | Purpose | Examples |
|-------|---------|----------|
| ğŸ”„ | Starting/refreshing operations | Starting polling, refresh cycles |
| âœ… | Successful operations | Completed successfully, timer started |
| âŒ | Failed operations | Failed to authenticate, API errors |
| ğŸš€ | Initialization/startup | Starting monitoring, user authenticated |
| ğŸ›‘ | Stopping/shutdown | Stopping timer, user not authenticated |
| ğŸ“¡ | Network operations | Sending requests, API calls |
| ğŸ’¡ | Light operations | Color updates, device management |
| ğŸ¨ | Color changes | **High-visibility color logging** |
| ğŸ‘¤ | Teams status | Status updates, presence changes |
| ğŸ“… | Calendar/meetings | Meeting detection, countdown logic |
| ğŸ”‘ | Authentication | Auth status changes, token operations |
| â° | Timer operations | Timer fires, scheduled events |
| ğŸ“Š | Data processing | Token validation, data parsing |
| ğŸ¯ | Decision logic | Color determination, priority logic |
| â„¹ï¸ | Informational | No-op operations, status info |
| âš ï¸ | Warnings | Rate limits, non-critical issues |
| ğŸ§ª | Development/testing | Mock data generation |

### Log Severity Levels

#### **Critical (âŒ)**
- Authentication failures
- API errors  
- Device control failures
- Build/configuration issues

#### **Important (âœ…/ğŸ”„)**
- Successful operations
- Status changes
- Timer events
- Color changes

#### **Informational (â„¹ï¸/ğŸ“Š)**
- Process steps
- Data validation
- Performance metrics
- No-op operations

#### **Debug (ğŸ§ª)**
- Mock data operations
- Development mode indicators
- Detailed internal state

### High-Visibility Logging

#### **TERMINAL COLOR LOG Messages**
These messages are specifically designed for high visibility in terminal output:

- `ğŸ¨ TERMINAL COLOR LOG: Lights changing from RGB({old}) to RGB({new})`
- `âœ… TERMINAL COLOR LOG: Successfully changed {device} to RGB({r},{g},{b})`

**Purpose**: Easy identification of actual light color changes among all other log messages.

### Timing Information

#### **Request Duration Logging**
- `â±ï¸ MicrosoftGraphService: API request completed in {X.XX}s`

**Purpose**: Performance monitoring and API response time tracking.

#### **Periodic Operations**
- Every 15 seconds: Teams status polling sequence
- Every 15 seconds: Light color evaluation and updates
- On demand: Device discovery and manual refreshes

---

## Troubleshooting with Logs

### Common Issues and Log Patterns

#### **Teams Status Not Updating**
Look for:
1. `ğŸ”‘ TeamsService: Authentication status changed to: true`
2. `â° TeamsService: 15-second restart cycle triggered (valid: true)`
3. `ğŸ”„ MicrosoftGraphService: Starting Teams status polling attempt...`
4. `âœ… MicrosoftGraphService: Teams status updated successfully`

#### **Lights Not Changing Color**
Look for:
1. `ğŸ¯ StatusLightViewModel: Determining target color...`
2. `ğŸ¨ StatusLightViewModel: Color changed! Sending commands to...`
3. `âœ… TERMINAL COLOR LOG: Successfully changed {device} to RGB(...)`

#### **Device Discovery Issues**
Look for:
1. `ğŸ” Starting Govee device discovery...`
2. `ğŸ“± StatusLightViewModel: Received {count} devices from GoveeService`
3. `âœ… Govee device discovery completed successfully`

#### **Authentication Problems**
Look for:
1. `ğŸ”‘ TeamsService: Authentication status changed to: false`
2. `âŒ MicrosoftGraphService: No access token available`
3. `ğŸ” MicrosoftGraphService: Authentication expired (401)`

---

*This document covers all log messages as of the current StatusLight application version. Log messages may be added or modified as the application evolves.*